{% extends "base.html" %}
{% load static %}

<!-- Reference to related css file -->
{% block custom_css %}
    <link rel="stylesheet" href="{% static 'css/form.css' %}" />
{% endblock %}

{% block content %}
    {% if offer %}
        <div class="container">
            <div class="section">
                <div class="row">
                    <div class="col-lg-6 col-md-6 col-xs-12" id="desccol">
                        <h3 class="tittleh3">DESCRIPCIÓN DEL CARGO:</h3>
                        <p id="tittledescription">{{ cargo.description }}</p>
                        <br>
                        <a href="{{ cargo.bumeranLink }}" target="_blank"><img src="{% static "images/bumeran.jpg" %}" class="linksimages" ></a>
                        <a href="{{ cargo.linkedInLink }}" target="_blank"><img src="{% static "images/linkedin.jpg" %}" class="linksimages" ></a>
                        <br><br><br>
                        <img src="{% static "images/captacion.jpg" %}" id="tittleimage">
                    </div>
                    <div class="col-lg-6 col-md-6 col-xs-12" id="questionscol">
                        <form enctype="multipart/form-data" class="form-horizontal form-validate form-inline" action="" method="post" accept-charset="utf-8" class="form-group" role="form" id="formularioform">
                            <h3 class="tittleh3">INSCRÍBETE AL CARGO DE:</h3>
                            <h3 class="tittlecargo">{{ cargo.name }}</h3>
                            <h6 class="campsobligatorios">* Obligatorio</h6>
                            <br>
                            <h5 class="tittleh4">CONTACTO</h5>
                            <hr class="separator"/>
                            {% for field in form1 %}
                                <div class="control-group" id="{{field.name}}-state">
                                    <div class="input-group">
                                        <span class="input-group-addon tags-unete label-agruppa fields" id="basic-addon1"><b>{{ field.label }} <span class="red">*</span></b></span>{{ field }}
                                    </div>
                                    <!-- Not valid fields and errors validation -->
                                    <span class="error" id="{{ field.name }}-icon"></span>
                                    <span class='error' id='{{field.name}}-error' aria-live="polite"></span>
                                    {{ field.errors }}
                                </div>
                            {% endfor %}
                            <br>
                            <h5 class="tittleh4">RESIDENCIA</h5>
                            <hr class="separator"/>
                            {% for field in form2 %}
                                <div class="control-group" id="{{field.name}}-state">
                                    <div class="input-group">
                                        <span class="input-group-addon tags-unete label-agruppa fields" id="basic-addon1"><b>{{ field.label }} <span class="red">*</span></b></span>{{ field }}
                                    </div>
                                    <!-- Not valid fields and errors validation -->
                                    <span class="error" id="{{ field.name }}-icon"></span>
                                    <span class='error' id='{{field.name}}-error' aria-live="polite"></span>
                                    {{ field.errors }}
                                </div>
                            {% endfor %}
                            <br>
                            <h5 class="tittleh4">FORMACIÓN</h5>
                            <hr class="separator"/>
                            {% for field in form3 %}
                                <div class="control-group" id="{{field.name}}-state">
                                    <div class="input-group">
                                        <span class="input-group-addon tags-unete label-agruppa fields" id="basic-addon1"><b>{{ field.label }} <span class="red">*</span></b></span>{{ field }}
                                    </div>
                                    <!-- Not valid fields and errors validation -->
                                    <span class="error" id="{{ field.name }}-icon"></span>
                                    <span class='error' id='{{field.name}}-error' aria-live="polite"></span>
                                    {{ field.errors }}
                                </div>
                            {% endfor %}
                            <br>
                            <h5 class="tittleh4">CV</h5>
                            <hr class="separator"/>
                            {% for field in form4 %}
                                <div class="control-group" id="{{field.name}}-state">
                                    <div class="input-group">
                                        <span class="input-group-addon tags-unete label-agruppa fields" id="basic-addon1"><b>{{ field.label }} <span class="red">*</span></b></span>{{ field }}
                                    </div>
                                    <!-- Not valid fields and errors validation -->
                                    <span class="error" id="{{ field.name }}-icon"></span>
                                    <span class='error' id='{{field.name}}-error' aria-live="polite"></span>
                                    {{ field.errors }}
                                </div>
                            {% endfor %}
                            <br>
                            <h5 class="tittleh4">SALARIOS</h5>
                            <hr class="separator"/>
                            {% for field in form5 %}
                                <div class="control-group" id="{{field.name}}-state">
                                    <div class="input-group">
                                        <span class="input-group-addon tags-unete label-agruppa fields" id="basic-addon1"><b>{{ field.label }} <span class="red">*</span></b></span>{{ field }}
                                    </div>
                                    <!-- Not valid fields and errors validation -->
                                    <span class="error" id="{{ field.name }}-icon"></span>
                                    <span class='error' id='{{field.name}}-error' aria-live="polite"></span>
                                    {{ field.errors }}
                                </div>
                            {% endfor %}
                            <br>
                            {% if questions %}
                                <h5 class="tittleh4">POR FAVOR, CONTESTE LAS SIGUIENTES PREGUNTAS</h5>
                                <hr class="separator"/>
                                {% for q in questions %}
                                    <div class="control-group" id="{{q.id}}-state">
                                        <div class="input-group">
                                            <span class="input-group-addon tags-unete label-agruppa questions" id="basic-addon1"><b>{{ q.question }} <span class="red">*</span></b></span>
                                            <input id="question{{ q.id }}" maxlength="500" name="questions{{ q.id }}" type="text" placeholder="Respuesta" required/>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}
                            <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
                            <input type="hidden" name="cargo" value="{{ cargo.id }}">
                            <!-- Sign up button to send the input values -->
                            <div class="checkbox">
                                <label id="terms"><input id="terms1" type="checkbox" value="" > Acepto los <a id="termsycond" target="_blank" href="http://www.idbcgroup.com/beconsult/terminos-y-condiciones">términos y condiciones</a></label>
                            </div>
                            <br><br>
                            <button class="btn btn-primary" type="submit" value="Registrar" id="submit_button"  disabled>Inscribirse</button>
                        </form>
                        <br><br>
                    </div>

                </div>
            </div>
        </div>
    {% else %}
        {% if exist %}
            <div class="container">
                <div class="section">
                    <div class="row" style="padding-top: 5%">
                        <div class="col-lg-2">
                        </div>
                        <div class="col-lg-8" id="colcenter" >
                            <img alt="Brand" src="{% static "images/logo_2000.png" %}"style="max-width: 28%;"><br><br><br><br>
                            <h3>No hay ofertas disponibles para el cargo <span style="font-weight: bold">{{ cargo }}</span></h3>
                            <br><br>
                        </div>
                        <div class="col-lg-2">
                        </div>
                    </div>
                </div>
            </div>
        {% else %}
            <div class="container">
                <div class="section">
                    <div class="row" style="padding-top: 5%">
                        <div class="col-lg-2">
                        </div>
                        <div class="col-lg-8" id="colcenter" >
                            <img alt="Brand" src="{% static "images/logo_2000.png" %}"style="max-width: 28%;"><br><br><br><br>
                            <h3>El cargo solicitado no existe</h3>
                            <br><br>
                        </div>
                        <div class="col-lg-2">
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
    {% endif %}


{% endblock %}

<!-- jQuery Functions needed -->
{% block custom_script %}
    <script>
        $( document ).ready(function() {
            $( "#terms1" ).change(function() {
                if ($('#terms1').prop('checked')) {
                    $('#submit_button').removeAttr('disabled');
                }else{
                    $('#submit_button').attr('disabled','disabled');
                }
            });
        });

        $(function() {
            $( ".datepicker" ).datepicker({
                changeMonth: true,
                changeYear: true,
                yearRange: "1900:2018",
                dateFormat: 'dd-mm-yy'
            });
        });

        $("#id_documentId").on('change keyup paste', function () {
            var documentId = $("#id_documentId").val();
            var pattern = /^([0-9])*$/;
            var bool = false;
            if (documentId.match(pattern)){
                if (documentId.length>9 || documentId.length<6){
                    $('#id_documentId').css('border-color', 'red');
                    $( "span" ).each(function(index, val ) {
                        if (val.id==='doc'){
                            bool = true
                        }
                    });
                    if (bool === false){
                        $("#documentId-state").append('<span id="doc">Cédula inválida</span>');
                        $('#doc').css('color','red');
                    }
                }
                else {
                    $('#doc').remove();
                    $('#id_documentId').css('border-bottom-color', '#a7a2a2');
                }
            }
            else{
                $('#id_documentId').css('border-color', 'red');
                $( "span" ).each(function(index, val ) {
                    if (val.id==='doc'){
                        bool = true
                    }
                });
                if(bool===false){
                    $("#documentId-state").append('<span id="doc">Cédula inválida</span>');
                    $('#doc').css('color','red');
                }
            }
        });

        $("#id_birthDate").on('change keyup paste', function () {
            var birthDate= $("#id_birthDate").val();
            var day;
            var month;
            var year;
            var bool = false;
            var pattern =/^([0-9]{2})\-([0-9]{2})\-([0-9]{4})$/;

            if (!birthDate.match(pattern)) {
                $('#id_birthDate').css('border-color', 'red');
                $( "span" ).each(function(index, val ) {
                    if (val.id==='msg'){
                        bool = true
                    }
                });
                if (bool === false){
                    $('#birthDate-state').append('<span id="msg">Fecha inválida</span>');
                    $('#msg').css('color','red');
                }

            }
            else {
                $('#msg').remove();
                $('#id_birthDate').css('border-bottom-color', '#a7a2a2');
            }

        });
        $("#id_email").on('change keyup paste', function () {
            var email = $("#id_email").val();
            var regexp = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            var bool = false;
            if (regexp.test(email.toLowerCase())){
                $('#email').remove();
                $('#id_email').css('border-bottom-color', '#a7a2a2');
            }
            else{
                $('#email').remove();
                $("#email-state").append('<span id="email">Correo inválido</span>');
                $('#email').css('color','red');
            }
        });

        $('#id_cv').on( 'change', function() {
            myfile = $( this ).val();
            var ext = myfile.split('.').pop();
            if(!(ext=="pdf")){
                alert('El CV solo puede estar en formato .PDF');
                $( this ).val("");
            }
        });

        {% if messages %}
            {% for message in messages %}
                $.toaster({
                    // toast message
                    message : '{{ message }}',
                    // toast title
                    title : '',
                    // or 'success', 'info', 'warning', 'danger'
                    priority : 'success'
                });
            {% endfor %}
        {% endif %}

    </script>
{% endblock %}